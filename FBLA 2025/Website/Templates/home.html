{% extends "base.html" %}
{% block title %}Discover | AllyMarket{% endblock %}

{% block content %}
<div class="discover-wrapper">
  <center>
    <div class="biz-list">
      <h1>Discover Local Businesses!</h1> <!-- Motto -->

      <!-- üîç Search Bar -->
      <form method="GET" action="{{ url_for('views.home') }}" class="search-form">
        <input
          type="text"
          name="q"
          placeholder="Search businesses..."
          value="{{ search_query or '' }}"
          class="search-input"
        >
        <button type="submit" class="btn btn-primary">Search</button>
      </form>

      {% if search_query %}
        <p class="muted">Showing results for "<strong>{{ search_query }}</strong>"</p>
      {% endif %}

      {% if businesses and businesses|length > 0 %}
      <div class="biz-grid">
  {% for b in businesses %}
  <a href="{{ url_for('views.business_page', biz_id=b.id) }}" class="biz-card-link">
    <article class="card biz-card">
    <div class="biz-image-container" style="display: flex; flex-direction: column; justify-content: center; align-items: center; margin: 20px 0;">
      {% if b.image_file %}
      <div class="biz-image-wrap">
      <img src="{{ url_for('static', filename='uploads/businesses/' + b.image_file) }}"
         alt="{{ b.biz_name }}"
         class="biz-image">
      </div>
        {% else %}
        <div class="biz-placeholder"> <!-- Placeholder icon for businesses without images -->
          <span class="placeholder-icon" style="font-size: 100pt;">üè¨</span> 
      {% endif %}

      <div class="biz-card-head">
      <h4>{{ b.biz_name }}</h4>
      <span class="badge">{{ b.category }}</span>
      </div>

      insert location <!-- TODO -->

      {% if b.created_at %}
      <div class="biz-card-foot">
        Added {{ b.created_at.strftime('%b %d, %Y') }}     <!-- Date Created-->
      </div>
      {% endif %}
    </div>

    </article>

  </a>
{% endfor %}
</div>
      {% else %}
        <p class="muted">
          {% if search_query %}
            No businesses found matching "{{ search_query }}".
          {% else %}
            No businesses have been added yet.
          {% endif %}
        </p>
      {% endif %}
    </div>
  </center>
</div>
{% endblock %}

